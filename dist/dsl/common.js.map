{"version":3,"file":"common.js","names":["inst: Instance<PageProps>","id: string","path: string","lifecycle: string","obj?: Record<string, unknown>","options?: Record<string, unknown>","component: any","pageName?: string","data?: Record<string, unknown>","pageConfig?: PageConfig","pageElement: TaroRootElement | null","prepareMountList: (() => void)[]","page: MpInstance","loadResolver: (...args: unknown[]) => void","hasLoaded: Promise<void>","config: PageInstance","options: Readonly<Record<string, unknown>>","cb?: TFunc","id","component: React.ComponentClass","componentName?: string","componentElement: TaroRootElement | null","config: any","extraOptions: { [key: string]: any }"],"sources":["../../src/dsl/common.ts"],"sourcesContent":["/* eslint-disable dot-notation */\nimport {\n  EMPTY_OBJ, ensure, EventChannel,\n  getComponentsAlias, hooks, internalComponents,\n  isArray, isFunction, isString, isUndefined, Shortcuts\n} from '@tarojs/shared'\n\nimport { raf } from '../bom/raf'\nimport { taroWindowProvider } from '../bom/window'\nimport { BEHAVIORS, CONTEXT_ACTIONS, CUSTOM_WRAPPER, EXTERNAL_CLASSES, ON_HIDE, ON_LOAD, ON_READY, ON_SHOW, OPTIONS, PAGE_INIT, VIEW } from '../constants'\nimport { Current } from '../current'\nimport { eventHandler } from '../dom/event'\nimport { eventCenter } from '../emitter/emitter'\nimport env from '../env'\nimport { perf } from '../perf'\nimport { customWrapperCache, incrementId } from '../utils'\nimport { addLeadingSlash } from '../utils/router'\n\nimport type { TaroRootElement } from '../dom/root'\nimport type { MpInstance, PageConfig, TFunc } from '../interface'\nimport type { Instance, PageInstance, PageProps } from './instance'\n\nconst instances = new Map<string, Instance>()\nconst pageId = incrementId()\n\nexport function injectPageInstance (inst: Instance<PageProps>, id: string) {\n  hooks.call('mergePageInstance', instances.get(id), inst)\n  instances.set(id, inst)\n}\n\nexport function getPageInstance (id: string): Instance | undefined {\n  return instances.get(id)\n}\n\nexport function removePageInstance (id: string) {\n  instances.delete(id)\n}\n\nexport function safeExecute (path: string, lifecycle: string, ...args: unknown[]) {\n  const instance = instances.get(path)\n\n  if (instance == null) {\n    return\n  }\n\n  const func = hooks.call('getLifecycle', instance, lifecycle as keyof PageInstance)\n\n  if (isArray(func)) {\n    const res = func.map(fn => fn.apply(instance, args))\n    return res[0]\n  }\n\n  if (!isFunction(func)) {\n    return\n  }\n\n  return func.apply(instance, args)\n}\n\nexport function stringify (obj?: Record<string, unknown>) {\n  if (obj == null) {\n    return ''\n  }\n  const path = Object.keys(obj).map((key) => {\n    return key + '=' + obj[key]\n  }).join('&')\n  return path === '' ? path : '?' + path\n}\n\nexport function getPath (id: string, options?: Record<string, unknown>): string {\n  const idx = id.indexOf('?')\n  if (process.env.TARO_PLATFORM === 'web') {\n    return `${idx > -1 ? id.substring(0, idx) : id}${stringify(options?.stamp ? { stamp: options.stamp } : {})}`\n  } else {\n    return `${idx > -1 ? id.substring(0, idx) : id}${stringify(options)}`\n  }\n}\n\nexport function getOnReadyEventKey (path: string) {\n  return path + '.' + ON_READY\n}\n\nexport function getOnShowEventKey (path: string) {\n  return path + '.' + ON_SHOW\n}\n\nexport function getOnHideEventKey (path: string) {\n  return path + '.' + ON_HIDE\n}\n\nexport function createPageConfig (component: any, pageName?: string, data?: Record<string, unknown>, pageConfig?: PageConfig) {\n  // 小程序 Page 构造器是一个傲娇小公主，不能把复杂的对象挂载到参数上\n  const id = pageName ?? `taro_page_${pageId()}`\n  const [\n    ONLOAD,\n    ONUNLOAD,\n    ONREADY,\n    ONSHOW,\n    ONHIDE,\n    LIFECYCLES,\n    SIDE_EFFECT_LIFECYCLES,\n  ] = hooks.call('getMiniLifecycleImpl')!.page\n  let pageElement: TaroRootElement | null = null\n  let unmounting = false\n  let prepareMountList: (() => void)[] = []\n\n  function setCurrentRouter (page: MpInstance) {\n    const router = process.env.TARO_PLATFORM === 'web' ? page.$taroPath : page.route || page.__route__ || page.$taroPath\n    Current.router = {\n      params: page.$taroParams!,\n      path: addLeadingSlash(router),\n      $taroPath: page.$taroPath,\n      onReady: getOnReadyEventKey(id),\n      onShow: getOnShowEventKey(id),\n      onHide: getOnHideEventKey(id)\n    }\n    if (!isUndefined(page.exitState)) {\n      Current.router.exitState = page.exitState\n    }\n  }\n  let loadResolver: (...args: unknown[]) => void\n  let hasLoaded: Promise<void>\n  const config: PageInstance = {\n    [ONLOAD] (this: MpInstance, options: Readonly<Record<string, unknown>> = {}, cb?: TFunc) {\n      hasLoaded = new Promise(resolve => { loadResolver = resolve })\n\n      perf.start(PAGE_INIT)\n\n      Current.page = this as any\n      this.config = pageConfig || {}\n\n      // this.$taroPath 是页面唯一标识\n      const uniqueOptions = Object.assign({}, options, { $taroTimestamp: Date.now() })\n      const $taroPath = this.$taroPath = getPath(id, uniqueOptions)\n      if (process.env.TARO_PLATFORM === 'web') {\n        config.path = $taroPath\n      }\n      // this.$taroParams 作为暴露给开发者的页面参数对象，可以被随意修改\n      if (this.$taroParams == null) {\n        this.$taroParams = uniqueOptions\n      }\n\n      setCurrentRouter(this)\n\n      // 初始化当前页面的上下文信息\n      if (process.env.TARO_PLATFORM !== 'web') {\n        taroWindowProvider.trigger(CONTEXT_ACTIONS.INIT, $taroPath)\n      }\n\n      const mount = () => {\n        Current.app!.mount!(component, $taroPath, () => {\n          pageElement = env.document.getElementById<TaroRootElement>($taroPath)\n\n          ensure(pageElement !== null, '没有找到页面实例。')\n          safeExecute($taroPath, ON_LOAD, this.$taroParams)\n          loadResolver()\n          if (process.env.TARO_PLATFORM !== 'web') {\n            pageElement.ctx = this\n            pageElement.performUpdate(true, cb)\n          } else {\n            isFunction(cb) && cb()\n          }\n        })\n      }\n      if (unmounting) {\n        prepareMountList.push(mount)\n      } else {\n        mount()\n      }\n    },\n    [ONUNLOAD] () {\n      const $taroPath = this.$taroPath\n      // 销毁当前页面的上下文信息\n      if (process.env.TARO_PLATFORM !== 'web') {\n        taroWindowProvider.trigger(CONTEXT_ACTIONS.DESTORY, $taroPath)\n      }\n      // 触发onUnload生命周期\n      safeExecute($taroPath, ONUNLOAD)\n      unmounting = true\n      Current.app!.unmount!($taroPath, () => {\n        unmounting = false\n        instances.delete($taroPath)\n        if (pageElement) {\n          pageElement.ctx = null\n          pageElement = null\n        }\n        if (prepareMountList.length) {\n          prepareMountList.forEach(fn => fn())\n          prepareMountList = []\n        }\n      })\n    },\n    [ONREADY] () {\n      hasLoaded.then(() => {\n        // 触发生命周期\n        safeExecute(this.$taroPath, ON_READY)\n        // 通过事件触发子组件的生命周期\n        raf(() => eventCenter.trigger(getOnReadyEventKey(id)))\n        this.onReady.called = true\n      })\n    },\n    [ONSHOW] (options = {}) {\n      hasLoaded.then(() => {\n        // 设置 Current 的 page 和 router\n        Current.page = this as any\n        setCurrentRouter(this)\n        // 恢复上下文信息\n        if (process.env.TARO_PLATFORM !== 'web') {\n          taroWindowProvider.trigger(CONTEXT_ACTIONS.RECOVER, this.$taroPath)\n        }\n        // 触发生命周期\n        safeExecute(this.$taroPath, ON_SHOW, options)\n        // 通过事件触发子组件的生命周期\n        raf(() => eventCenter.trigger(getOnShowEventKey(id)))\n      })\n    },\n    [ONHIDE] () {\n      // 缓存当前页面上下文信息\n      if (process.env.TARO_PLATFORM !== 'web') {\n        taroWindowProvider.trigger(CONTEXT_ACTIONS.RESTORE, this.$taroPath)\n      }\n      // 设置 Current 的 page 和 router\n      if (Current.page === this) {\n        Current.page = null\n        Current.router = null\n      }\n      // 触发生命周期\n      safeExecute(this.$taroPath, ON_HIDE)\n      // 通过事件触发子组件的生命周期\n      eventCenter.trigger(getOnHideEventKey(id))\n    }\n  }\n\n  if (process.env.TARO_PLATFORM === 'web') {\n    config.getOpenerEventChannel = () => {\n      return EventChannel.pageChannel\n    }\n  }\n\n  LIFECYCLES.forEach((lifecycle) => {\n    let isDefer = false\n    lifecycle = lifecycle.replace(/^defer:/, () => {\n      isDefer = true\n      return ''\n    })\n    config[lifecycle] = function () {\n      const exec = () => safeExecute(this.$taroPath, lifecycle, ...arguments)\n      if (isDefer) {\n        hasLoaded.then(exec)\n      } else {\n        return exec()\n      }\n    }\n  })\n\n  // onShareAppMessage 和 onShareTimeline 一样，会影响小程序右上方按钮的选项，因此不能默认注册。\n  SIDE_EFFECT_LIFECYCLES.forEach(lifecycle => {\n    if (component[lifecycle] ||\n      component.prototype?.[lifecycle] ||\n      component[lifecycle.replace(/^on/, 'enable')] ||\n      pageConfig?.[lifecycle.replace(/^on/, 'enable')]\n    ) {\n      config[lifecycle] = function (...args) {\n        const target = args[0]?.target\n        if (target?.id) {\n          const id = target.id\n          const element = env.document.getElementById(id)\n          if (element) {\n            target.dataset = element.dataset\n          }\n        }\n        return safeExecute(this.$taroPath, lifecycle, ...args)\n      }\n    }\n  })\n\n  config.eh = eventHandler\n\n  if (!isUndefined(data)) {\n    config.data = data\n  }\n\n  hooks.call('modifyPageObject', config)\n\n  return config\n}\n\nexport function createComponentConfig (component: React.ComponentClass, componentName?: string, data?: Record<string, unknown>) {\n  const id = componentName ?? `taro_component_${pageId()}`\n  let componentElement: TaroRootElement | null = null\n  const [ATTACHED, DETACHED] = hooks.call('getMiniLifecycleImpl')!.component\n\n  const config: any = {\n    [ATTACHED] () {\n      perf.start(PAGE_INIT)\n      this.pageIdCache = this.getPageId?.() || pageId()\n\n      const path = getPath(id, { id: this.pageIdCache })\n\n      Current.app!.mount!(component, path, () => {\n        componentElement = env.document.getElementById<TaroRootElement>(path)\n        ensure(componentElement !== null, '没有找到组件实例。')\n        this.$taroInstances = instances.get(path)\n        safeExecute(path, ON_LOAD)\n        if (process.env.TARO_PLATFORM !== 'web') {\n          componentElement.ctx = this\n          componentElement.performUpdate(true)\n        }\n      })\n    },\n    [DETACHED] () {\n      const path = getPath(id, { id: this.pageIdCache })\n\n      Current.app!.unmount!(path, () => {\n        instances.delete(path)\n        if (componentElement) {\n          componentElement.ctx = null\n        }\n      })\n    },\n    methods: {\n      eh: eventHandler\n    }\n  }\n\n  if (!isUndefined(data)) {\n    config.data = data\n  }\n\n  [OPTIONS, EXTERNAL_CLASSES, BEHAVIORS].forEach(key => {\n    config[key] = component[key] ?? EMPTY_OBJ\n  })\n\n  return config\n}\n\nexport function createRecursiveComponentConfig (componentName?: string) {\n  const isCustomWrapper = componentName === CUSTOM_WRAPPER\n  const [ATTACHED, DETACHED] = hooks.call('getMiniLifecycleImpl')!.component\n\n  const lifeCycles = isCustomWrapper\n    ? {\n      [ATTACHED] () {\n        const componentId = this.data.i?.sid || this.props.i?.sid\n        if (isString(componentId)) {\n          customWrapperCache.set(componentId, this)\n          const el = env.document.getElementById(componentId)\n          if (el) {\n            el.ctx = this\n          }\n        }\n      },\n      [DETACHED] () {\n        const componentId = this.data.i?.sid || this.props.i?.sid\n        if (isString(componentId)) {\n          customWrapperCache.delete(componentId)\n          const el = env.document.getElementById(componentId)\n          if (el) {\n            el.ctx = null\n          }\n        }\n      }\n    }\n    : EMPTY_OBJ\n\n  // 不同平台的个性化配置\n  const extraOptions: { [key: string]: any } = {}\n  if (process.env.TARO_ENV === 'jd') {\n    extraOptions.addGlobalClass = true\n  }\n\n  return hooks.call('modifyRecursiveComponentConfig',\n    {\n      properties: {\n        i: {\n          type: Object,\n          value: {\n            [Shortcuts.NodeName]: getComponentsAlias(internalComponents)[VIEW]._num\n          }\n        },\n        l: {\n          type: String,\n          value: ''\n        }\n      },\n      options: {\n        ...extraOptions,\n        virtualHost: !isCustomWrapper\n      },\n      methods: {\n        eh: eventHandler\n      },\n      ...lifeCycles\n    }, { isCustomWrapper })\n}\n"],"mappings":"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"}