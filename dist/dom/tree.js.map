{"version":3,"file":"tree.js","names":["root: TaroElement","predict?: Filter","array: TaroElement[]","object: TaroElement | null","el: TaroElement","current: TaroElement | null"],"sources":["../../src/dom/tree.ts"],"sourcesContent":["import { NodeType } from './node_types'\n\nimport type { TaroElement } from './element'\n\ntype Filter = (element: TaroElement) => boolean\n\nfunction returnTrue () {\n  return true\n}\n\nexport function treeToArray (root: TaroElement, predict?: Filter): TaroElement[] {\n  const array: TaroElement[] = []\n  const filter = predict ?? returnTrue\n\n  let object: TaroElement | null = root\n\n  while (object) {\n    if (object.nodeType === NodeType.ELEMENT_NODE && filter(object)) {\n      array.push(object)\n    }\n\n    object = following(object, root)\n  }\n\n  return array\n}\n\nfunction following (el: TaroElement, root: TaroElement): TaroElement | null {\n  const firstChild = el.firstChild\n  const isElmentTypeValid = el.nodeType === NodeType.ELEMENT_NODE || el.nodeType === NodeType.DOCUMENT_NODE\n\n  // 如果当前 el 不是 element 或 document 元素，则可以直接不递归他的子元素了\n  if (firstChild && isElmentTypeValid) {\n    return firstChild as TaroElement\n  }\n\n  let current: TaroElement | null = el\n\n  do {\n    if (current === root) {\n      return null\n    }\n\n    const nextSibling = current.nextSibling\n\n    if (nextSibling) {\n      return nextSibling as TaroElement\n    }\n    current = current.parentElement\n  } while (current)\n\n  return null\n}\n"],"mappings":";;;AAMA,SAAS,aAAc;AACrB,QAAO;AACR;AAED,SAAgB,YAAaA,MAAmBC,SAAiC;CAC/E,MAAMC,QAAuB,CAAE;CAC/B,MAAM,SAAS,WAAW;CAE1B,IAAIC,SAA6B;AAEjC,QAAO,QAAQ;AACb,MAAI,OAAO,aAAa,SAAS,gBAAgB,OAAO,OAAO,EAAE;AAC/D,SAAM,KAAK,OAAO;EACnB;AAED,WAAS,UAAU,QAAQ,KAAK;CACjC;AAED,QAAO;AACR;AAED,SAAS,UAAWC,IAAiBJ,MAAuC;CAC1E,MAAM,aAAa,GAAG;CACtB,MAAM,oBAAoB,GAAG,aAAa,SAAS,gBAAgB,GAAG,aAAa,SAAS;AAG5F,KAAI,cAAc,mBAAmB;AACnC,SAAO;CACR;CAED,IAAIK,UAA8B;AAElC,IAAG;AACD,MAAI,YAAY,MAAM;AACpB,UAAO;EACR;EAED,MAAM,cAAc,QAAQ;AAE5B,MAAI,aAAa;AACf,UAAO;EACR;AACD,YAAU,QAAQ;CACnB,SAAQ;AAET,QAAO;AACR"}